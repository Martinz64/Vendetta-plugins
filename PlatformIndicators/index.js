(function(D,d,c,b,l,E,i,S,x,n,B){"use strict";const{View:N,Text:Y,Pressable:W}=i.ReactNative,C=c.findByName("Svg",!1).default,V=c.findByName("Svg",!1).Path,k={desktop:"M4 2.5c-1.103 0-2 .897-2 2v11c0 1.104.897 2 2 2h7v2H7v2h10v-2h-4v-2h7c1.103 0 2-.896 2-2v-11c0-1.103-.897-2-2-2H4Zm16 2v9H4v-9h16Z",web:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93Zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39Z",mobile:"M15.5 1h-8A2.5 2.5 0 0 0 5 3.5v17A2.5 2.5 0 0 0 7.5 23h8a2.5 2.5 0 0 0 2.5-2.5v-17A2.5 2.5 0 0 0 15.5 1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5-4H7V4h9v14z"};function L(r){const{platform:u,color:f}=r;return React.createElement(N,null,React.createElement(C,{height:"16",width:"16",viewBox:"0 0 24 24",fill:f},React.createElement(V,{d:k[u]})))}const H={online:i.chroma(S.rawColors.GREEN_360).hex(),dnd:i.chroma(S.rawColors.RED_400).hex(),idle:i.chroma(S.rawColors.YELLOW_300).hex(),offline:i.chroma(S.rawColors.PRIMARY_400).hex()};function P(r){return H[r]}const U=c.findByStoreName("PresenceStore"),F=c.findByStoreName("SessionsStore"),$=c.findByStoreName("UserStore");let g,w=0,T,M;function A(){return T||(T=setTimeout(function(){w=0,T=null},5e3)),(!g||w==0)&&(g=U.getState()),w=(w+1)%20,g}function O(r){let u;return M||(M=$.getCurrentUser().id),r==M?u=Object.values(F.getSessions()).reduce(function(f,p){return p.clientInfo.client!=="unknown"&&(f[p.clientInfo.client]=p.status),f},{}):u=A()?.clientStatuses[r],u}function y(r){const u=r.userId,f=O(u);return E.createElement(E.Fragment,null,Object.keys(f??{}).map(function(p){return E.createElement(L,{platform:p,color:P(f[p])})}))}const{View:Z}=i.ReactNative;function j(){return B.useProxy(n.storage),i.React.createElement(Z,null,i.React.createElement(b.Forms.FormSwitchRow,{label:"DM Top Bar",subLabel:"Show icons on the dm top bar",value:n.storage.dmTopBar??!0,onValueChange:function(r){return n.storage.dmTopBar=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Users/DMs list",subLabel:"Show icons on the users and DMs list",value:n.storage.userList??!0,onValueChange:function(r){return n.storage.userList=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Profile name",subLabel:"Show icons on user profiles",value:n.storage.profileUsername??!0,onValueChange:function(r){return n.storage.profileUsername=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Disable mobile icon",subLabel:"Hide mobile status from the normal indicator",value:n.storage.removeDefaultMobile??!0,onValueChange:function(r){return n.storage.removeDefaultMobile=r},note:""}))}const{Text:q,View:R}=b.General;let h=[];var z={onLoad:function(){n.storage.dmTopBar??=!0,n.storage.userList??=!0,n.storage.profileUsername??=!0,n.storage.removeDefaultMobile??=!0;const r=c.findByDisplayName("Pressable",!1);h.push(d.patcher.before("render",r.default.type,function(s){if(!s||!s[0])return;const[e]=s;if(e){if(e.accessibilityRole=="button"){if(!n.storage.userList)return;if(e.children&&e.children.length>=2&&e.children[0]?.props?.user){if(!e.children[0]||!e.children[0]?.props?.user)return;const t=e.children[0]?.props?.user?.id;if(!t)return;e.children.find(function(o){return o.key=="StatusIcons"})||e.children.push(React.createElement(R,{key:"StatusIcons",style:{display:"flex",flexDirection:"row"}}));const a=e.children.find(function(o){return o.key=="StatusIcons"});a.props.children=React.createElement(y,{userId:t})}}if(e.accessibilityRole=="header"){if(!n.storage.dmTopBar)return;if(l.findInReactTree(e.children,function(t){return t.props?.title&&t.props?.icon})){const t=l.findInReactTree(e.children,function(a){return a.props?.title&&a.props?.icon});if(t.props?.titleSuffix){l.findInReactTree(t.props.titleSuffix,function(o){return o.key=="DMStatusIndicators"})||(t.props.titleSuffix=[t.props.titleSuffix,React.createElement(R,{key:"DMStatusIndicators",style:{flexDirection:"row"}})]);const a=l.findInReactTree(t.props.titleSuffix,function(o){return o.props?.userId}).props?.userId;if(a){const o=l.findInReactTree(t.props.titleSuffix,function(v){return v.key=="DMStatusIndicators"});o&&(o.props.children=React.createElement(y,{userId:a}))}}}}}})),c.findByStoreName("PresenceStore"),h.push(d.patcher.after("type",c.findByProps("DirectMessageRow").DirectMessageRow,function(s,e){if(!e.props?.user)return;const t=e.props?.user?.id;t&&d.patcher.after("type",e,function(a,o){const v=l.findInReactTree(o,function(I){return I.props?.children[0]?.type?.displayName=="View"});v.props.children[0].props.children[0]=React.createElement(R,{style:{flexDirection:"row"}},v.props.children[0].props.children[0],React.createElement(R,{style:{marginLeft:2,flexDirection:"row"}},React.createElement(y,{userId:t})))})})),h.push(d.patcher.after("default",c.findByName("ChannelHeader",!1),function(s,e){n.storage.dmTopBar&&e.type?.type?.name=="PrivateChannelHeader"&&d.patcher.after("type",e.type,function(t,a){if(!a.props?.children?.props?.children)return;const o=l.findInReactTree(a,function(m){return m.props?.user?.id})?.props?.user?.id;if(!o)return;const v=a.props?.children;if(!l.findInReactTree(a,function(m){return m.key=="DMTabsV2Header"})){const m=x.getAssetIDByName("arrow-right");l.findInReactTree(v,function(G){return G.props?.children[1]?.props?.source==m}).props?.children?.push(React.createElement(R,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},React.createElement(R,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const I=l.findInReactTree(a,function(m){return m.key=="DMTabsV2HeaderIcons"});I&&(I.props.children=React.createElement(y,{userId:o}))})}));const u=c.findByName("DefaultName",!1);h.push(d.patcher.after("default",u,function(s,e){const t=s[0]?.user;t!==void 0&&e&&t.id&&n.storage.profileUsername&&e.props?.children[0]?.props?.children?.push(React.createElement(y,{userId:t.id}))}));const f=c.findByName("DisplayName",!1);h.push(d.patcher.after("default",f,function(s,e){const t=s[0]?.user;t!==void 0&&e&&t.id&&n.storage.profileUsername&&e.props?.children?.props?.children[0]?.props?.children?.push(React.createElement(y,{userId:t.id}))}));const p=c.findByName("Status",!1);h.push(d.patcher.before("default",p,function(s){s&&s[0]&&n.storage.removeDefaultMobile&&(s[0].isMobileOnline=!1)}))},onUnload:function(){h.forEach(function(r){return r()})},settings:function(){return React.createElement(j,null)}};return D.default=z,Object.defineProperty(D,"__esModule",{value:!0}),D})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui,vendetta.ui.assets,vendetta.plugin,vendetta.storage);
