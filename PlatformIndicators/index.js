(function(B,p,d,w,l,t,c,D,v,r,V){"use strict";const{View:N,Text:ee,Image:x,Pressable:re}=c.ReactNative;d.findByName("Svg",!1).default,d.findByName("Svg",!1).Path,D.getAssetIDByName("ic_monitor_24px"),D.getAssetIDByName("ic_globe_24px"),D.getAssetIDByName("ic_mobile_device"),D.getAssetIDByName("ic_monitor_24px");const L={desktop:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAACvv7+3u7+5u7+2ub+4u726vL65u765vL65vMG5u723ub23v7+3t7+6vL+4ur+6u765u764vL+4ur23t7+7vb+3ur25ur64ur+7u766ur6vr7/+1nXbAAAAHHRSTlMAEEB/UHDv/99fgIAgQJ+f7++fnyB/YN9vTz8QSaZf3QAAAI1JREFUeAHt1tUBwkAURNEXHZzg1n+d2Fc8u4OTOQXcyKqJ3ARh5C22qiQFYTC0khFIYyuYgDYthGagzQuhDLRFIYS7yBPuakLmSaF2CimkkEIKKfT8I5un0MdCT7v6LUFbFUIhaGsr2IAUWcl2B0K2t6pDVKttGR5P3BJvpxCnfdTMHVo9NaRQ1MpKRC5jHSw3VFQzIwAAAABJRU5ErkJggg==",path:"PlatformIndicators/Desktop.png"},web:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAQAAAD/5HvMAAADgklEQVR42u3a32vVdRzH8VdOv2NzGzM7bkp0E9F9RQSbOmK6groQpeugOzXJfnCW3YwgC4IyHCldrBmFELtQRxfK2MHp1sjVZRfBMSJFYu6cMUnOOZPz9Gb45uyc79fv5/tDvDiPv+DJh/fn8+HL56umpqbHFZsZ4hjjzJOnQJkyBfLMM87H7GWzHh16OcoVKgQpM8N79Cht7GaSVcJa5QK7lBZe5SpRzDCgpLGdH6gS3SRPKzm8xTJxFTmgJNDKtyRllFbFQxfTRLVCvSk6FR3b+J3onuRTlllvgUzk1YmVsyJJdPMN1bqkzmizM00cc1rDIP9SawpPrjhFPAf1AN1cotZJ940ezwKb1q33BLX2Kzx2sBwzZ7vWoYXvAVOkV2FxlqjuMMtBNqkBNpIDzI/h7ywnTsfIP5gquxUGV3EiB7zMPcxlPRwDOJITTgNmpx6GyZSDnqKAOa9g9LKKIzniA0yFbQrC+5B6UDf/Y44oCFdwdUPOGMfkgr8kyrg6Lmf0YUq0yw9DuLnBcTw5YwNFzB754RhmkYaUCH7BDMsPZzDDZFMM+gQzJj/8inlTYiS1oNcws/LD35jnJUtKPOgFzHX5YQmzdmCRTSXoGcyi/FDGtEqWlHhQG6YULsjTA4zg5iZf4CkAXrig25gtUowk+FwB2IpZDDfUz8pEWiUF4DnM9XDbfkiKl6QAvB5u248H38KMJBZ0FDMW7uo4qwbIJhQ0gcnKD3sxN3lCirNKgZfrf5hB+aGdEuYVNUQ2dtAuTIk2+WMG87V8MBIzaBQzrdDDVqBDPuIE0cUy5rCC0MMq5lAqQR9hKmRcPoNu0ZF0EN0sYs7JBAyc+UwNsUJYd7nGO2zUGr4CTL9MqMGu8KIaYB43C2yVJPq4h8kpDAaoYv6kS3U4jKvfaGELeUyVfoXDT4C5wAatg8cfuHqbS4A54/K8UgTMd/WnNjuckyqAKdCj8DhArdO0NFilQ8xxhyiq7JMbRqk1GXAEuDshV3hMUesvXkoo6CKe3NHJArUqfEln7KBrdCgaMnVJcIsPa6OcczKKjk6mqFfkFH20RAi6SIfiweMkjS0xwTBvEFaVE3hKAvspEleBfUoOvTGfOH+mJ40X6ctEkaNfaWEn56kQVoVz9CltZDhCjhJBSuR4l4weHdrZwzBjzJFniTJlbpNnljGyDNLW/BmlqelxdR++AoGbDB4jjAAAAABJRU5ErkJggg==",path:"PlatformIndicators/Web.png"},mobile:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAXVBMVEUAAAAwMDgwMDUwMDUuMDYwMDYvMTcvMTYvMTYwMDYwMDUvMTYwMjUvMTUvMjYvMTUuMDUuMDQvMDUtMTUwMDgvMDUwMDAtMDYuMDYwMDAtMDUvMDYuMDUtMDcpMTo5aAq8AAAAH3RSTlMAIGBvf1C//89fMN9g75+/j3+fP0C/IFBfMGDPb08fcZ9WCgAAAMNJREFUeAHt2YWNxQAMg2EX/fiVud1/zBuhSaRjfwv8UsQx5J9L0iw/VySIyUoaXa7wu93pcE/g9KDTFS4F+amF5Em3ZwK7FwPeMEsYcoNVxZAaViX5uTd6MuQJKwY5A01u9goFWph1fyKggAIKKKCAAgoooIACCiiggAIKKKCAAgoooIACn/l9d/t3gU/fcEqG9LDKGVLB6saQAZ97owZ2w5NuzwEOKd1G4FMLE5wG36Y/w29ZadRviBn2/Nw2HfjTPgD3/UVA1TCAGgAAAABJRU5ErkJggg==",path:"PlatformIndicators/Mobile.png"},embedded:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAk1BMVEUAAAC3u7+4ur+5vL+5u765u7+6vL+2ub+3v7+6u7+5vL66v7+6vL65u761ur+4u765vL+3t7+6u765u7+9vb23t7+7vb+6u766ur+5ur6/v7+vv7+9vcW1tb+5u727u763ur25vL+6vL+3ub24ur+5u7+4vL+5ur66ur64ur25vL+6u764ur24u722uby5u76vr7/eehxsAAAAMXRSTlMAQJ/f/8+fUCC/3zDv7zC/UEDvfx8gf88w3xAQHzCAT2Bfb4Bvj5/PP6+vv59wUM8QEONx+AAAAWZJREFUeAHt1dWa6zAMBOA5PSqzs2Vmhvd/uWWcVFHqr5f+r+3JRqtJ8UhBEAT/Mv8lpWwuD02hKHcpFXBTuSJ3qtZwQ0HPUVULiCuJhzpiGuKlCZaTL3gnxEVPaLWdkAxYJznIdfGmy0k9MEkOivChLQSkbwS18KElZEBBLSMIX4QMuRxaEJ0vCBndCkJMbEZjIRO6MTWCqjWlRjO6MTeCpLoooDWuCFvSjcgK0pYzohsrM0hZzhXdWJtBynJyR4rGv19dzrp3EC3nhoJKZpCynNxalzqIlrPKU7WDlOXUym8H0XIOufy+htxZX9tHBU24/L5mXH5fSy6/r4jL/8sOidYJv2x7fu0k84SgIn/Qmb50dT2oB6YXk+tf4hElWuuPdeaIlCFx/fkLeM+Q1Ferw3RQZ9SmP8jQlR9H/NZ3tKmG08+sW/SMnrxzZ6Qy/TrfBWkdL+Lq0RUptaYHJyU+HwRB4O0FjTMnvIkvoBQAAAAASUVORK5CYII=",path:"PlatformIndicators/Console.png"}};function K(n){const{platform:h,color:m}=n,u=n.iconSize??16;return React.createElement(N,null,React.createElement(x,{style:{height:u,width:u,tintColor:m},source:{uri:L[h].url,width:u,height:u,path:L[h].path,allowTheming:!0}}))}const J={online:c.chroma(v.rawColors.GREEN_360).hex(),dnd:c.chroma(v.rawColors.RED_400).hex(),idle:c.chroma(v.rawColors.YELLOW_300).hex(),offline:c.chroma(v.rawColors.PRIMARY_400).hex()},z={online:"#23a55a",dnd:"#f23f43",idle:"#f0b232",offline:"#80848e"};function P(n){return arguments.length>1&&arguments[1]!==void 0&&arguments[1]?z[n]:J[n]}const G=d.findByStoreName("PresenceStore"),H=d.findByStoreName("SessionsStore"),Q=d.findByStoreName("UserStore");let U,R=0,T,S;function Y(){return T||(T=setTimeout(function(){R=0,T=null},5e3)),(!U||R==0)&&(U=G.getState()),R=(R+1)%20,U}function O(n){let h;return S||(S=Q.getCurrentUser()?.id),n==S?h=Object.values(H.getSessions()).reduce(function(m,u){return u.clientInfo.client!=="unknown"&&(m[u.clientInfo.client]=u.status),m},{}):h=Y()?.clientStatuses[n],h}function M(n){V.useProxy(r.storage);const h=n.userId,m=n.size??16,u=O(h);return t.createElement(t.Fragment,null,Object.keys(u??{}).map(function(b){return t.createElement(K,{platform:b,color:P(u[b],r.storage.fallbackColors),iconSize:m})}))}const{View:j,ScrollView:Z}=c.ReactNative;function q(){return V.useProxy(r.storage),c.React.createElement(Z,null,c.React.createElement(j,null,c.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on the dm top bar",value:r.storage.dmTopBar??!0,onValueChange:function(n){return r.storage.dmTopBar=n},note:""}),c.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on the users and DMs list",value:r.storage.userList??!0,onValueChange:function(n){return r.storage.userList=n},note:""}),c.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on user profiles",value:r.storage.profileUsername??!0,onValueChange:function(n){return r.storage.profileUsername=n},note:""}),c.React.createElement(w.Forms.FormSwitchRow,{label:"Hide mobile status from the normal indicator",value:r.storage.removeDefaultMobile??!0,onValueChange:function(n){return r.storage.removeDefaultMobile=n},note:""}),c.React.createElement(w.Forms.FormSwitchRow,{label:"Theme compatibility mode",value:r.storage.fallbackColors??!1,onValueChange:function(n){return r.storage.fallbackColors=n},note:""}),c.React.createElement(w.Forms.FormSwitchRow,{label:"Old user list icon style",value:r.storage.oldUserListIcons??!1,onValueChange:function(n){return r.storage.oldUserListIcons=n},note:"Moves status indicators to the right"})))}const C=function(n){let{children:h}=n;const[m,u]=t.useState(0);return t.useEffect(function(){const b=function(){u(function(I){return I+1})};return c.FluxDispatcher.subscribe("PRESENCE_UPDATES",b),function(){c.FluxDispatcher.unsubscribe("PRESENCE_UPDATES",b)}},[]),t.Children.map(h,function(b,I){return t.cloneElement(b,{key:`${I}-${m}`})})},{Text:te,View:y}=w.General;let g=[];var W={onLoad:function(){r.storage.dmTopBar??=!0,r.storage.userList??=!0,r.storage.profileUsername??=!0,r.storage.removeDefaultMobile??=!0,r.storage.fallbackColors??=!1,r.storage.oldUserListIcons??=!1,g.push(p.patcher.after("render",y,function(i,e){if(r.storage.dmTopBar){const o=l.findInReactTree(e,function(s){return s?.props?.children[1]?.type?.name=="ChannelActivity"&&s?.props?.children[1]?.props?.hasOwnProperty?.("userId")});if(!o||o.props?.children?.length!=2||o.props?.children[0]?.props?.children?.length!=2)return;const a=o.props?.children[0]?.props?.children;if(a.filter(function(s){return s?.props?.userId}).length==2){const s=a[1],A=s.props?.userId;if(!A)return;p.patcher.after("type",s,function(k,f){return l.findInReactTree(f,function(E){return E.key=="StatusIcons"})||(f=t.createElement(y,{style:{display:"flex",flexDirection:"row"}},f,t.createElement(C,{key:"StatusIcons"},t.createElement(M,{userId:A})))),f})}}}));const n=d.findByDisplayName("Pressable",!1);g.push(p.patcher.before("render",n.default.type,function(i){if(!i||!i[0])return;const[e]=i;if(e){if(r.storage.userList&&e?.children?.props?.children?.props?.children&&e.children.props.children.props.children[1]?.type?.type?.name=="ChannelUnreadBadge"){const o=e.children.props.children,a=l.findInReactTree(o,function(s){return s?.user});if(a?.user&&!l.findInReactTree(e,function(s){return s?.key=="TabsV2-DM-List"})){const s=l.findInReactTree(e,function(A){return A?.props?.variant=="text-md/semibold"||A?.props?.variant=="redesign/channel-title/semibold"});s&&(s.props.children=[s.props.children,t.createElement(y,{key:"TabsV2-DM-List",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},t.createElement(C,null,t.createElement(M,{userId:a.user.id})))])}}if(e.accessibilityRole=="button"){if(!r.storage.userList)return;if(e.children&&e.children.length>=2&&(e.children[0]?.props?.user&&e.children[0]?.props?.channel||r.storage.oldUserListIcons)){if(!e.children[0]||!e.children[0]?.props?.user)return;const o=e.children[0]?.props?.user?.id;if(!o)return;e.children?.find(function(s){return s.key=="StatusIcons"})||e.children.push(t.createElement(y,{key:"StatusIcons",style:{display:"flex",flexDirection:"row"}}));const a=e.children?.find(function(s){return s.key=="StatusIcons"});a.props.children=t.createElement(M,{userId:o})}}if(e.accessibilityRole=="button"){if(!r.storage.userList)return;if(e?.children?.props?.children?.props?.children&&e?.children?.props?.children?.props?.children[0]?.type?.type?.name=="GuildContainerIndicator"){const o=e?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.user?.id;if(e?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.guildId)return;if(o){const a=e?.children?.props?.children?.props?.children[2]?.props?.children[0];if(a){const s=a.props.children[0].props.children;l.findInReactTree(s,function(A){return A.key=="DMTabsV2DMList-v2"})||s.push(t.createElement(C,{key:"DMTabsV2DMList-v2"},t.createElement(M,{userId:o})))}}}}}})),d.findByStoreName("PresenceStore"),g.push(p.patcher.after("default",d.findByName("ChannelHeader",!1),function(i,e){r.storage.dmTopBar&&e.type?.type?.name=="PrivateChannelHeader"&&p.patcher.after("type",e.type,function(o,a){if(!a.props?.children?.props?.children)return;const s=l.findInReactTree(a,function(f){return f.props?.user?.id})?.props?.user?.id;if(!s)return;const A=a.props?.children;if(!l.findInReactTree(a,function(f){return f.key=="DMTabsV2Header"})&&A.props?.children?.props?.children[1])if(typeof A.props?.children?.props?.children[1]?.type=="function"){const f=A.props?.children?.props?.children[1],E=p.patcher.after("type",f,function(ne,F){E(),l.findInReactTree(F,function(_){return _.key=="DMTabsV2Header-v2"})||F.props.children[0].props.children.push(t.createElement(C,{key:"DMTabsV2Header-v2"},t.createElement(M,{userId:s})))})}else{const f=D.getAssetIDByName("arrow-right");l.findInReactTree(A,function(E){return E.props?.children[1]?.props?.source==f}).props?.children?.push(t.createElement(y,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},t.createElement(y,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const k=l.findInReactTree(a,function(f){return f.key=="DMTabsV2HeaderIcons"});k&&(k.props.children=t.createElement(M,{userId:s}))})}));const h=d.findByName("DefaultName",!1);g.push(p.patcher.after("default",h,function(i,e){const o=i[0]?.user;o!==void 0&&e&&o.id&&r.storage.profileUsername&&e.props?.children[0]?.props?.children?.push(t.createElement(M,{userId:o.id}))}));const m=d.findByName("DisplayName",!1);g.push(p.patcher.after("default",m,function(i,e){const o=i[0]?.user;o!==void 0&&e&&o.id&&r.storage.profileUsername&&e.props?.children?.props?.children[0]?.props?.children?.push(t.createElement(M,{userId:o.id}))}));const u=d.findByName("Status",!1);g.push(p.patcher.before("default",u,function(i){i&&i[0]&&r.storage.removeDefaultMobile&&(i[0].isMobileOnline=!1)}));const b=d.findByProps("GuildMemberRow");b?.GuildMemberRow&&g.push(p.patcher.after("type",b.GuildMemberRow,function(i,e){let[{user:o}]=i;!r.storage.userList||r.storage.oldUserListIcons||l.findInReactTree(e,function(a){return a.key=="GuildMemberRowStatusIconsView"})||l.findInReactTree(e,function(a){return a.props.style.flexDirection==="row"}).props.children.splice(2,0,t.createElement(y,{key:"GuildMemberRowStatusIconsView",style:{flexDirection:"row"}},t.createElement(M,{userId:o.id})))}));let I=!1;const X=function(i,e){let[{user:o}]=i;r.storage.userList&&(l.findInReactTree(e?.props?.label,function(a){return a.key=="TabsV2MemberListStatusIconsView"})||(e.props.label=t.createElement(y,{style:{justifyContent:r.storage.oldUserListIcons?"space-between":"flex-start",flexDirection:"row",alignItems:"center"},key:"TabsV2MemberListStatusIconsView"},e.props.label,t.createElement(y,{key:"TabsV2MemberListStatusIconsView",style:{flexDirection:"row"}},t.createElement(M,{userId:o.id}))),window.iv2=e.props.label,I||(g.push(p.patcher.before("type",e.props.icon.type,function(a){r.storage.removeDefaultMobile&&(a[0].isMobileOnline=!1)})),I=!0)))};d.findByTypeNameAll("UserRow").forEach(function(i){return g.push(p.patcher.after("type",i,X))});const $=d.findByTypeName("MessagesItemChannelContent");g.push(p.patcher.after("type",$,function(i,e){console.log("MessagesItemChannelContent-B",i,e);const o=i[0]?.channel;if(o?.recipients?.length==1){const a=o.recipients[0];l.findInReactTree(e,function(s){return s.props.children[0].props.variant=="redesign/channel-title/semibold"}).props.children.push(t.createElement(y,{key:"TabsV2RedesignDMListIcons",style:{flexDirection:"row"}},t.createElement(M,{userId:a})))}}))},onUnload:function(){g.forEach(function(n){return n()})},settings:function(){return t.createElement(q,null)}};return B.default=W,Object.defineProperty(B,"__esModule",{value:!0}),B})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui.assets,vendetta.ui,vendetta.plugin,vendetta.storage);
