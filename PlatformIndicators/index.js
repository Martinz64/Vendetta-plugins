(function(g,u,c,R,w,t,s,I,C,n,N){"use strict";const{View:M,Text:J,Pressable:K}=s.ReactNative,x=c.findByName("Svg",!1).default,V=c.findByName("Svg",!1).Path,k={desktop:"M4 2.5c-1.103 0-2 .897-2 2v11c0 1.104.897 2 2 2h7v2H7v2h10v-2h-4v-2h7c1.103 0 2-.896 2-2v-11c0-1.103-.897-2-2-2H4Zm16 2v9H4v-9h16Z",web:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93Zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39Z",mobile:"M15.5 1h-8A2.5 2.5 0 0 0 5 3.5v17A2.5 2.5 0 0 0 7.5 23h8a2.5 2.5 0 0 0 2.5-2.5v-17A2.5 2.5 0 0 0 15.5 1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5-4H7V4h9v14z"};function H(r){const{platform:i,color:l}=r;return React.createElement(M,null,React.createElement(x,{height:"16",width:"16",viewBox:"0 0 24 24",fill:l},React.createElement(V,{d:k[i]})))}const P={online:s.chroma(I.rawColors.GREEN_360).hex(),dnd:s.chroma(I.rawColors.RED_400).hex(),idle:s.chroma(I.rawColors.YELLOW_300).hex(),offline:s.chroma(I.rawColors.PRIMARY_400).hex()};function F(r){return P[r]}const L=c.findByStoreName("PresenceStore"),U=c.findByStoreName("SessionsStore"),A=c.findByStoreName("UserStore");let D,b=0,B,T;function O(){return B||(B=setTimeout(function(){b=0,B=null},5e3)),(!D||b==0)&&(D=L.getState()),b=(b+1)%20,D}function Z(r){let i;return T||(T=A.getCurrentUser().id),r==T?i=Object.values(U.getSessions()).reduce(function(l,f){return f.clientInfo.client!=="unknown"&&(l[f.clientInfo.client]=f.status),l},{}):i=O()?.clientStatuses[r],i}function S(r){const i=r.userId,l=Z(i);return t.createElement(t.Fragment,null,Object.keys(l??{}).map(function(f){return t.createElement(H,{platform:f,color:F(l[f])})}))}const{View:j,ScrollView:z}=s.ReactNative;function G(){return N.useProxy(n.storage),s.React.createElement(z,null,s.React.createElement(j,null,s.React.createElement(R.Forms.FormSwitchRow,{label:"Show icons on the dm top bar",value:n.storage.dmTopBar??!0,onValueChange:function(r){return n.storage.dmTopBar=r},note:""}),s.React.createElement(R.Forms.FormSwitchRow,{label:"Show icons on the users and DMs list",value:n.storage.userList??!0,onValueChange:function(r){return n.storage.userList=r},note:""}),s.React.createElement(R.Forms.FormSwitchRow,{label:"Show icons on user profiles",value:n.storage.profileUsername??!0,onValueChange:function(r){return n.storage.profileUsername=r},note:""}),s.React.createElement(R.Forms.FormSwitchRow,{label:"Hide mobile status from the normal indicator",value:n.storage.removeDefaultMobile??!0,onValueChange:function(r){return n.storage.removeDefaultMobile=r},note:""})))}const Y=function(r){let{children:i}=r;const[l,f]=t.useState(0);return t.useEffect(function(){const a=setInterval(function(){f(function(e){return e+1})},2e3);return function(){clearInterval(a)}},[]),t.Children.map(i,function(a,e){return t.cloneElement(a,{key:`${e}-${l}`})})},{Text:Q,View:E}=R.General;let y=[];var W={onLoad:function(){n.storage.dmTopBar??=!0,n.storage.userList??=!0,n.storage.profileUsername??=!0,n.storage.removeDefaultMobile??=!0,y.push(u.patcher.after("render",E,function(a,e){if(!n.storage.dmTopBar)return;const o=w.findInReactTree(e,function(v){return v?.props?.children[1]?.type?.name=="ChannelActivity"&&v?.props?.children[1]?.props?.hasOwnProperty?.("userId")});if(!o)return;const d=o.props.children[1].props.userId;o.props.children[0];const p=o.props.children[0].props.children[1];u.patcher.after("type",p,function(v,h){return w.findInReactTree(h,function(m){return m.key=="StatusIcons"})||(h=t.createElement(E,{style:{display:"flex",flexDirection:"row"}},h,t.createElement(Y,{key:"StatusIcons"},t.createElement(S,{userId:d})))),h})}));const r=c.findByDisplayName("Pressable",!1);y.push(u.patcher.before("render",r.default.type,function(a){if(!a||!a[0])return;const[e]=a;if(e&&e.accessibilityRole=="button"){if(!n.storage.userList)return;if(e.children&&e.children.length>=2&&e.children[0]?.props?.user){if(!e.children[0]||!e.children[0]?.props?.user)return;const o=e.children[0]?.props?.user?.id;if(!o)return;e.children.find(function(p){return p.key=="StatusIcons"})||e.children.push(t.createElement(E,{key:"StatusIcons",style:{display:"flex",flexDirection:"row"}}));const d=e.children.find(function(p){return p.key=="StatusIcons"});d.props.children=t.createElement(S,{userId:o})}}})),c.findByStoreName("PresenceStore"),y.push(u.patcher.after("type",c.findByProps("DirectMessageRow").DirectMessageRow,function(a,e){if(!e.props?.user)return;const o=e.props?.user?.id;o&&u.patcher.after("type",e,function(d,p){const v=w.findInReactTree(p,function(h){return h.props?.children[0]?.type?.displayName=="View"});v.props.children[0].props.children[0]=t.createElement(E,{style:{flexDirection:"row"}},v.props.children[0].props.children[0],t.createElement(E,{style:{marginLeft:2,flexDirection:"row"}},t.createElement(S,{userId:o})))})})),y.push(u.patcher.after("default",c.findByName("ChannelHeader",!1),function(a,e){n.storage.dmTopBar&&e.type?.type?.name=="PrivateChannelHeader"&&u.patcher.after("type",e.type,function(o,d){if(!d.props?.children?.props?.children)return;const p=w.findInReactTree(d,function(m){return m.props?.user?.id})?.props?.user?.id;if(!p)return;const v=d.props?.children;if(!w.findInReactTree(d,function(m){return m.key=="DMTabsV2Header"})){const m=C.getAssetIDByName("arrow-right");w.findInReactTree(v,function(q){return q.props?.children[1]?.props?.source==m}).props?.children?.push(t.createElement(E,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},t.createElement(E,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const h=w.findInReactTree(d,function(m){return m.key=="DMTabsV2HeaderIcons"});h&&(h.props.children=t.createElement(S,{userId:p}))})}));const i=c.findByName("DefaultName",!1);y.push(u.patcher.after("default",i,function(a,e){const o=a[0]?.user;o!==void 0&&e&&o.id&&n.storage.profileUsername&&e.props?.children[0]?.props?.children?.push(t.createElement(S,{userId:o.id}))}));const l=c.findByName("DisplayName",!1);y.push(u.patcher.after("default",l,function(a,e){const o=a[0]?.user;o!==void 0&&e&&o.id&&n.storage.profileUsername&&e.props?.children?.props?.children[0]?.props?.children?.push(t.createElement(S,{userId:o.id}))}));const f=c.findByName("Status",!1);y.push(u.patcher.before("default",f,function(a){a&&a[0]&&n.storage.removeDefaultMobile&&(a[0].isMobileOnline=!1)}))},onUnload:function(){y.forEach(function(r){return r()})},settings:function(){return t.createElement(G,null)}};return g.default=W,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui,vendetta.ui.assets,vendetta.plugin,vendetta.storage);
