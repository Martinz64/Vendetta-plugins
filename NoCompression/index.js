(function(r,c,t,n,o,d,u,p,f){"use strict";const{View:g,ScrollView:m}=o.ReactNative;function h(){return d.useProxy(n.storage),o.React.createElement(m,null,o.React.createElement(g,null,o.React.createElement(u.Forms.FormSwitchRow,{label:"Compress files bigger than the limit",value:n.storage.compressBig??!0,onValueChange:function(e){return n.storage.compressBig=e},note:""})))}const y=t.findByProps("show","confirm","close"),v=t.findByProps("getChannel","getDMFromUserId"),B=t.findByProps("getGuild"),{BoostedGuildFeatures:b}=t.findByProps("BoostedGuildFeatures"),{getUserMaxFileSize:w}=t.findByProps("getUserMaxFileSize");function C(e){let i=0;const s=v.getChannel(e).guild_id;if(s){const P=B.getGuild(s).premiumTier;i=b[P].limits.fileSize}const a=w();return a>i?a:i}let l=[];var F={onLoad:function(){n.storage.compressBig??=!1;const e=t.findByProps("CloudUpload").CloudUpload;l.push(c.before("reactNativeCompressAndExtractData",e.prototype,function(i){let s=!0;const a=C(this.channelId);this.preCompressionSize>a&&n.storage.compressBig&&(s=!1,p.showToast("File is too big, compression will be allowed.",f.getAssetIDByName("ic_message_copy"))),s&&(this.reactNativeFilePrepped=!0,this.currentSize=this.preCompressionSize,this.mimeType=="image/png"&&!this.filename.endsWith(".png")&&(this.filename=this.filename+".png"),this.mimeType=="image/jpg"&&(!this.filename.endsWith(".jpg")||!this.filename.endsWith(".jpeg"))&&(this.filename=this.filename+".jpg"))})),l.push(c.before("handleError",e.prototype,function(i){i[0]==40005&&y.show({title:"File is too big to upload",body:"The size of the file you are trying to upload exceeds the maximum allowed size. You can allow compressing of big files in the plugin settings.",confirmText:"Accept",confirmColor:"brand"})}))},onUnload:function(){l.forEach(function(e){return e()})},settings:function(){return React.createElement(h,null)}};return r.default=F,Object.defineProperty(r,"__esModule",{value:!0}),r})({},vendetta.patcher,vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.components,vendetta.ui.toasts,vendetta.ui.assets);
